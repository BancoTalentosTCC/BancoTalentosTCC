!function(a){a.fn.shorten=function(b){"use strict";var c={showChars:100,minHideChars:10,ellipsesText:"...",moreText:"more",lessText:"less",onLess:function(){},onMore:function(){},errMsg:null,force:!1};return b&&a.extend(c,b),!(a(this).data("jquery.shorten")&&!c.force)&&(a(this).data("jquery.shorten",!0),a(document).off("click",".morelink"),a(document).on({click:function(){var b=a(this);return b.hasClass("less")?(b.removeClass("less"),b.html(c.moreText),b.parent().prev().animate({height:"0%"},function(){b.parent().prev().prev().show()}).hide("fast",function(){c.onLess()})):(b.addClass("less"),b.html(c.lessText),b.parent().prev().animate({height:"100%"},function(){b.parent().prev().prev().hide()}).show("fast",function(){c.onMore()})),!1}},".morelink"),this.each(function(){var b=a(this),d=b.html(),e=b.text().length;if(e>c.showChars+c.minHideChars){var f=d.substr(0,c.showChars);if(f.indexOf("<")>=0){for(var g=!1,h="",i=0,k=[],l=null,m=0,n=0;n<=c.showChars;m++)if("<"!=d[m]||g||(g=!0,l=d.substring(m+1,d.indexOf(">",m)),"/"==l[0]?l!="/"+k[0]?c.errMsg="ERROR en HTML: the top of the stack should be the tag that closes":k.shift():"br"!=l.toLowerCase()&&k.unshift(l)),g&&">"==d[m]&&(g=!1),g)h+=d.charAt(m);else if(n++,i<=c.showChars)h+=d.charAt(m),i++;else if(k.length>0){for(j=0;j<k.length;j++)h+="</"+k[j]+">";break}f=a("<div/>").html(h+'<span class="ellip">'+c.ellipsesText+"</span>").html()}else f+=c.ellipsesText;var o='<div class="shortcontent">'+f+'</div><div class="allcontent">'+d+'</div><span><a href="javascript://nop/" class="morelink">'+c.moreText+"</a></span>";b.html(o),b.find(".allcontent").hide(),a(".shortcontent p:last",b).css("margin-bottom",0)}}))}}(jQuery);